<h1>ショッピングカート</h1>
<%= link_to "カートを空にする", cart_items_destroy_all_path, method: :delete, "data-confirm" => "本当に空にしますか？" %>
<% @cart_items.each do |cart_item| %>
  <p>商品名</p>
  <p><%= cart_item.item.name %></p>
  <p>単価（税込）</p>
  <p><%= cart_item.item.with_tax_price%></p>
  <p>数量</p>
    <%= form_with model: cart_item do |f| %>
      <%= f.select :amount, *[1..99] %>
      <%= f.submit "カートに入れる" %>
    <% end %>
  <p>小計</p>
  <p><%= cart_item.subtotal %></p>
  <% @subtotal +=  cart_item.subtotal %>
  <%= link_to "削除する", cart_item_path(cart_item), method: :delete, "data-confirm" => "本当に消しますか？" %>
<% end %>
<p>合計金額</p>
<%= @subtotal %><br>
<%= link_to "買い物を続ける", root_path %>

<%= form_with url: '/orders/new', method: :get do |f| %>
  <%= f.hidden_field :total_price, :value => @subtotal %>
  <%= f.submit "情報入力に進む" %>
<% end %>
